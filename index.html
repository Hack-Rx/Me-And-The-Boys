<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Home</title>
	<style type="text/css">
		#rooms{
			border: 1px solid black;
			min-height: 444px;
		}
	</style>
</head>
<body>
	<div id="myid"></div>
	<div id="rooms"></div>
	<button onclick="createRoom()">Create Your Own Room</button>


	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://www.gstatic.com/firebasejs/7.15.1/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/7.15.1/firebase-database.js"></script>
	<script src="fireconfig.js"></script>
	<script src="https://cdn.plyr.io/3.6.2/plyr.js"></script>
	<script type="text/javascript">
		var id  =  localStorage.getItem("theid");
		if (!id) {
			id = Math.floor((Math.random() * 9999999) + 1);		
    	localStorage.setItem("theid", id);
		}
		$('#myid').append('<h3>Your User ID is : '+localStorage.getItem("theid")+'</h3>');

		const fdb = firebase.database();

    function createRoom(){
			fdb.ref('rooms/'+id).set({
				currentTime : 0,
				videoId : "none",
				isPlaying : false
			});
    }

    fdb.ref('rooms/').on('value', function(snapshot) {
    	var allrooms = snapshot.val();
    	let rnames = Object.keys(allrooms);
    	$('#rooms').empty();
    	rnames.forEach(name=>{
    		$('#rooms').append(`<a href='room.html?q=${name}'>Room No ${name}</a><br>`)
    	});
		});
		
// 0 2 @ * () % ^ & $ # ! 		
//file:///C:/Users/Rishabh/Documents/firesync/index.html
	</script>
</body>
</html>